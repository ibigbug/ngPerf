!function(angular){function ngPerf(modules,opt){angular.isArray(modules)||(modules=[modules]),this.modules=modules.map(function(mod){return angular.isString(mod)&&(mod=angular.module(mod)),mod}),this.options=angular.extend({},defualts,opt)}function formatString(){for(var raw=arguments[0],i=0;i<arguments.length;i++){var re=new RegExp("\\{"+(i-1)+"\\}","gm");raw=raw.replace(re,arguments[i])}return raw}window.ngPerf=ngPerf;var defualts={oneTime:!0,explictApply:!0,timeout:!0};ngPerf.prototype.setup=function(){var self=this;this.modules.map(function(mod){self.options.oneTime&&ngPerf.setupOneTime(mod),self.options.timeout&&ngPerf.setupTimeout(mod),self.options.explictApply&&ngPerf.setupExplictApply(mod),self.options.scopeMonitor&&ngPerf.setupScopeMonitor()})},ngPerf.setupOneTime=function(mod){mod.config(["$provide",function($provide){$provide.decorator("$interpolate",["$delegate",function($delegate){var interpolateWrap=function(){var interpolateFn=$delegate.apply(this,arguments);return interpolateFn?interpolationFnWrap(interpolateFn,arguments):void 0},interpolationFnWrap=function(interpolateFn,args){var cache={};return function(){var result=interpolateFn.apply(this,arguments),exp=args[0].replace("{{","").replace("}}","").trim();if(0===exp.indexOf("::"))return result;var hit=cache[exp];if(hit&&hit.val==result?hit.time+=1:cache[exp]={exp:exp,val:result,time:1},hit=cache[exp],hit.time>15){var logger=ngPerf.log("ONE-TIME-BIND");console.warn(logger(formatString("`{0}` evaluating same value `{1}` for 15 times, considering {{ ::{2} }}?",exp,result,exp)))}return result}};return angular.extend(interpolateWrap,$delegate),interpolateWrap}])}])},ngPerf.setupExplictApply=function(mod){mod.config(["$provide",function($provide){$provide.decorator("$rootScope",["$delegate",function($delegate){var $apply_=$delegate.constructor.prototype.$apply;return $delegate.constructor.prototype.$apply=function(){if($apply_.apply(this,arguments),this!==$delegate){var logger=ngPerf.log("EXPLICT-APPLY");console.warn(logger(formatString("Calling `$apply()` explictly on $scope::$id{0}, considering using `$digest()` ?",this.$id)))}},$delegate}])}])},ngPerf.setupTimeout=function(mod){mod.config(["$provide",function($provide){$provide.decorator("$timeout",["$delegate",function($delegate){var timeoutWrap=function(){var fn=arguments[0],delay=arguments[1],invokeApply=arguments[2];angular.isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop),$delegate.apply(this,arguments);var skipApply=angular.isDefined(invokeApply)&&!invokeApply;if(!skipApply&&0===delay){var logger=ngPerf.log("TIMEOUT");console.warn(logger(formatString("calling $timeout with delay 0, considering `$evalAsync()`?")))}};return angular.extend(timeoutWrap,$delegate),timeoutWrap}])}])},ngPerf.setupScopeMonitor=function(){function countScope(){return document.querySelectorAll(".ng-scope, .ng-isolate-scope").length}var m=new Monitor("$scope count");m.show(),window.setInterval(function(){m.data(countScope()/1e3*100)},500)},ngPerf.setupWatcherMonitor=function(){function countWatcher(){function countWatchersInNode(node){var element=angular.element(node);element.hasClass("ng-isolate-scope")&&element.isolateScope&&countWatchersInScope(element.isolateScope()),element.hasClass("ng-scope")&&countWatchersInScope(element.scope())}function countWatchersInScope(scope){scopeIds.hasOwnProperty(scope.$id)||(scopeIds[scope.$id]=!0,scope.$$watchers&&(total+=scope.$$watchers.length))}var total=0,scopeIds={};return angular.forEach(document.querySelectorAll(".ng-scope , .ng-isolate-scope"),countWatchersInNode),total}var m=new Monitor({title:"$watcher count",theme:"red"});m.show(),window.setInterval(function(){m.data(countWatcher()/1e4*100)},500)},ngPerf.log=function(type){return function(msg){return formatString("{0}:{1}",type,msg)}}}(angular),function(window,document){function Monitor(config){"string"==typeof config&&(config={title:config}),config.theme=config.theme||"green",config.draggable=isUndefined(config.draggable)?!0:config.draggable,this.config=config,this._frame=createFrame(),this._title=createTitle(config.theme),this._body=createBody(config.theme),this._data=[],this._freq=1,this.timer=null,this.setup(),this.config.title&&this.title(this.config.title)}function createFrame(){var frame=document.createElement("div");return frame.style.cssText=["border: 1px solid black;","background: black;","position: relative;","width: 100px;","height: 50px;","display: none;","margin-bottom: 5px;"].join(""),frame}function createTitle(theme){var title=document.createElement("div");return title.style.cssText=["position: absolute;","top: 0;","left: 0;","height: 30%;","width: 100%;",themes[theme].color,"font-size: 12px;","font-family: fantasy;"].join(""),title}function createBody(theme){var body=document.createElement("div");return body.style.cssText=[themes[theme].background,"position: absolute;","left: 0;","top: 30%;","height: 70%;","width: 100%"].join(""),body}function registerMouseDown(ele){ele.addEventListener("mousedown",function(){ele._dragging=!0})}function registerMouseMove(ele){var offsetX,offsetY,eleWidth=parseInt(ele.style.width,10),eleHeight=parseInt(ele.style.height,10);ele.addEventListener("mousemove",function(evt){ele._dragging&&(isUndefined(offsetX)&&(offsetX=_layer.offsetLeft+ele.offsetLeft,offsetY=_layer.offsetTop+ele.offsetTop),ele.style.left=evt.x-offsetX-eleWidth/2+"px",ele.style.top=evt.y-offsetY-eleHeight/2+"px")})}function registerMouseUp(ele){ele.addEventListener("mouseup",function(){ele._dragging=!1})}function isUndefined(val){return"undefined"==typeof val}var themes={green:{color:"color: green;",borderLeft:"border-left: 1px solid green;",background:"background: rgba(0, 200, 0, 0.3);"},red:{color:"color: red;",borderLeft:"border-left: 1px solid red;",background:"background: rgba(200, 0, 0, 0.3);"},blue:{color:"color: blue;",borderLeft:"border-left: 1px solid blue;",background:"background: rgba(0, 0, 200, 0.3);"}},_layer=null;Monitor.prototype.title=function(title){return title&&(this._title.innerHTML=title),this._title.innerHTML},Monitor.prototype.data=function(data){return data instanceof Array&&(this._data=data),parseInt(data,10)>0&&this._data.push(data),this._data},Monitor.prototype.show=function(){this._frame.style.display="block",this.autoRefresh(this._freq)},Monitor.prototype.hide=function(){this._frame.style.display="none",this.autoRefresh(0)},Monitor.prototype.setup=function(){_layer||(_layer=document.createElement("div"),_layer.style.cssText=["position: fixed;","top: 4%;","right: 1%;","z-index: 999999999999;"].join(""),_layer.setAttribute("id","yw-monitor-layer"),document.body.appendChild(_layer)),this._frame.appendChild(this._title),this._frame.appendChild(this._body),_layer.appendChild(this._frame),this.config.draggable&&this.draggable()},Monitor.prototype.refresh=function(){var percent_100=this._body.offsetWidth,data=this._data.slice(this.data.length-percent_100),start=percent_100-data.length;this._body.innerHTML="";for(var i=percent_100;i>start;i--){var index=percent_100-i;Monitor.paint(this,data[index],start+index)}},Monitor.prototype.autoRefresh=function(freq){var self=this;parseInt(freq,10)>0?(this._freq=freq,this.timer&&window.clearInterval(this.timer),this.timer=window.setInterval(function(){self.refresh()},1e3/freq)):window.clearInterval(this.timer)},Monitor.prototype.destroy=function(){this._data=null,document.body.removeChild(this._frame),window.clearInterval(this.timer)},Monitor.prototype.draggable=function(){registerMouseDown(this._frame),registerMouseMove(this._frame),registerMouseUp(this._frame)},Monitor.paint=function(self,height_percent,x){var line=document.createElement("div");line.style.cssText=["position: absolute;","left: "+x+"px;","bottom: 0;","width: 0;","height: "+height_percent+"%;",themes[self.config.theme].borderLeft].join(""),self._body.appendChild(line)},window.Monitor=Monitor}(window,document);
//# sourceMappingURL=build/ngPerf.min.js.map